{
  "id": null,
  "uid": "openwebui-user-simple",
  "title": "OpenWebUI - ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ",
  "tags": ["litellm", "openwebui", "user"],
  "timezone": "browser",
  "refresh": "30s",
  "schemaVersion": 30,
  "time": {
    "from": "now-24h",
    "to": "now"
  },
  "templating": {
    "list": [
      {
        "name": "selected_user",
        "label": "ðŸ‘¤ ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ",
        "type": "query",
        "query": "SELECT DISTINCT sl.end_user as user_alias FROM \"LiteLLM_SpendLogs\" sl WHERE sl.metadata->>'user_api_key_team_alias' = 'OpenWebUI' AND sl.end_user IS NOT NULL AND sl.end_user != '' ORDER BY user_alias",
        "multi": false,
        "includeAll": false,
        "current": {
          "selected": false,
          "text": "",
          "value": ""
        },
        "options": [],
        "datasource": {
          "type": "postgres",
          "uid": "postgres"
        },
        "hide": 0,
        "sort": 0,
        "skipUrlSync": false
      }
    ]
  },
  "panels": [
    {
      "id": 20,
      "title": "Ð¡Ð²Ð¾Ð´ÐºÐ° Ð¿Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŽ",
      "type": "row",
      "gridPos": {"h": 1, "w": 24, "x": 0, "y": 0},
      "collapsed": false
    },
    {
      "id": 2,
      "title": "ðŸ’° ÐžÐ±Ñ‰Ð¸Ðµ Ñ€Ð°ÑÑ…Ð¾Ð´Ñ‹",
      "type": "stat",
      "gridPos": {"h": 8, "w": 4, "x": 0, "y": 1},
      "datasource": {"type": "postgres", "uid": "postgres"},
      "targets": [
        {
          "refId": "A",
          "format": "table",
          "rawSql": "SELECT\n  SUM(sl.spend) as total_spend\nFROM \"LiteLLM_SpendLogs\" sl\nWHERE\n  sl.\"startTime\" >= $__timeFrom()\n  AND sl.\"startTime\" < $__timeTo()\n  AND sl.metadata->>'user_api_key_team_alias' = 'OpenWebUI'\n  AND sl.end_user = '$selected_user'\n  AND sl.end_user IS NOT NULL\n  AND sl.end_user != ''"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "currencyUSD",
          "decimals": 2,
          "color": {"mode": "thresholds"},
          "thresholds": {
            "steps": [
              {"color": "green", "value": null},
              {"color": "yellow", "value": 10},
              {"color": "red", "value": 100}
            ]
          }
        }
      }
    },
    {
      "id": 3,
      "title": "ðŸ“Š Ð’ÑÐµÐ³Ð¾ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð²",
      "type": "stat",
      "gridPos": {"h": 8, "w": 4, "x": 4, "y": 1},
      "datasource": {"type": "postgres", "uid": "postgres"},
      "targets": [
        {
          "refId": "A",
          "format": "table",
          "rawSql": "SELECT\n  COUNT(*) as total_requests\nFROM \"LiteLLM_SpendLogs\" sl\nWHERE\n  sl.\"startTime\" >= $__timeFrom()\n  AND sl.\"startTime\" < $__timeTo()\n  AND sl.metadata->>'user_api_key_team_alias' = 'OpenWebUI'\n  AND sl.end_user = '$selected_user'\n  AND sl.end_user IS NOT NULL\n  AND sl.end_user != ''"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "decimals": 0
        }
      }
    },
    {
      "id": 4,
      "title": "â¬‡ï¸ Ð’Ñ…Ð¾Ð´Ð½Ñ‹Ðµ Ñ‚Ð¾ÐºÐµÐ½Ñ‹",
      "type": "stat",
      "gridPos": {"h": 8, "w": 4, "x": 8, "y": 1},
      "datasource": {"type": "postgres", "uid": "postgres"},
      "targets": [
        {
          "refId": "A",
          "format": "table",
          "rawSql": "SELECT\n  SUM(sl.prompt_tokens) as prompt_tokens\nFROM \"LiteLLM_SpendLogs\" sl\nWHERE\n  sl.\"startTime\" >= $__timeFrom()\n  AND sl.\"startTime\" < $__timeTo()\n  AND sl.metadata->>'user_api_key_team_alias' = 'OpenWebUI'\n  AND sl.end_user = '$selected_user'\n  AND sl.end_user IS NOT NULL\n  AND sl.end_user != ''"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "decimals": 0,
          "color": {"mode": "fixed", "fixedColor": "blue"}
        }
      }
    },
    {
      "id": 5,
      "title": "â¬†ï¸ Ð’Ñ‹Ñ…Ð¾Ð´Ð½Ñ‹Ðµ Ñ‚Ð¾ÐºÐµÐ½Ñ‹",
      "type": "stat",
      "gridPos": {"h": 8, "w": 4, "x": 12, "y": 1},
      "datasource": {"type": "postgres", "uid": "postgres"},
      "targets": [
        {
          "refId": "A",
          "format": "table",
          "rawSql": "SELECT\n  SUM(sl.completion_tokens) as completion_tokens\nFROM \"LiteLLM_SpendLogs\" sl\nWHERE\n  sl.\"startTime\" >= $__timeFrom()\n  AND sl.\"startTime\" < $__timeTo()\n  AND sl.metadata->>'user_api_key_team_alias' = 'OpenWebUI'\n  AND sl.end_user = '$selected_user'\n  AND sl.end_user IS NOT NULL\n  AND sl.end_user != ''"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "decimals": 0,
          "color": {"mode": "fixed", "fixedColor": "green"}
        }
      }
    },
    {
      "id": 6,
      "title": "âš–ï¸ Ð¡Ð¾Ð¾Ñ‚Ð½Ð¾ÑˆÐµÐ½Ð¸Ðµ Ð²Ñ…/Ð²Ñ‹Ñ…",
      "type": "stat",
      "gridPos": {"h": 8, "w": 4, "x": 16, "y": 1},
      "datasource": {"type": "postgres", "uid": "postgres"},
      "targets": [
        {
          "refId": "A",
          "format": "table",
          "rawSql": "SELECT\n  ROUND((SUM(sl.prompt_tokens)::numeric / NULLIF(SUM(sl.completion_tokens), 0))::numeric, 2) as token_ratio\nFROM \"LiteLLM_SpendLogs\" sl\nWHERE\n  sl.\"startTime\" >= $__timeFrom()\n  AND sl.\"startTime\" < $__timeTo()\n  AND sl.metadata->>'user_api_key_team_alias' = 'OpenWebUI'\n  AND sl.end_user = '$selected_user'\n  AND sl.end_user IS NOT NULL\n  AND sl.end_user != ''"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "decimal",
          "decimals": 2,
          "color": {"mode": "thresholds"},
          "thresholds": {
            "steps": [
              {"color": "green", "value": null},
              {"color": "yellow", "value": 2},
              {"color": "red", "value": 5}
            ]
          }
        }
      }
    },
    {
      "id": 7,
      "title": "âš¡ Ð­Ñ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ (Ð¢Ð¾ÐºÐµÐ½Ð¾Ð²/$)",
      "type": "stat",
      "gridPos": {"h": 8, "w": 4, "x": 20, "y": 1},
      "datasource": {"type": "postgres", "uid": "postgres"},
      "targets": [
        {
          "refId": "A",
          "format": "table",
          "rawSql": "SELECT\n  ROUND((SUM(sl.prompt_tokens + sl.completion_tokens)::numeric / NULLIF(SUM(sl.spend), 0))::numeric, 0) as tokens_per_dollar\nFROM \"LiteLLM_SpendLogs\" sl\nWHERE\n  sl.\"startTime\" >= $__timeFrom()\n  AND sl.\"startTime\" < $__timeTo()\n  AND sl.metadata->>'user_api_key_team_alias' = 'OpenWebUI'\n  AND sl.end_user = '$selected_user'\n  AND sl.end_user IS NOT NULL\n  AND sl.end_user != ''"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "decimals": 0,
          "displayName": "Ð¢Ð¾ÐºÐµÐ½Ð¾Ð²/$"
        }
      }
    },
    {
      "id": 15,
      "title": "ðŸ¤– ÐÐÐÐ›Ð˜Ð¢Ð˜ÐšÐ ÐœÐžÐ”Ð•Ð›Ð•Ð™",
      "type": "row",
      "gridPos": {"h": 1, "w": 24, "x": 0, "y": 9},
      "collapsed": false
    },
    {
      "id": 12,
      "title": "ðŸ’° Ð Ð°ÑÑ…Ð¾Ð´Ñ‹ Ð¿Ð¾ Ð¼Ð¾Ð´ÐµÐ»ÑÐ¼",
      "type": "barchart",
      "gridPos": {"h": 12, "w": 8, "x": 0, "y": 10},
      "datasource": {"type": "postgres", "uid": "postgres"},
      "targets": [
        {
          "refId": "A",
          "format": "table",
          "rawSql": "SELECT\n  sl.model as model,\n  SUM(sl.spend) as value\nFROM \"LiteLLM_SpendLogs\" sl\nWHERE\n  sl.\"startTime\" >= $__timeFrom()\n  AND sl.\"startTime\" < $__timeTo()\n  AND sl.metadata->>'user_api_key_team_alias' = 'OpenWebUI'\n  AND sl.end_user = '$selected_user'\n  AND sl.end_user IS NOT NULL\n  AND sl.end_user != ''\nGROUP BY sl.model\nHAVING SUM(sl.spend) > 0\nORDER BY value DESC"
        }
      ],
      "options": {
        "orientation": "horizontal",
        "barWidth": 0.8,
        "legend": {"displayMode": "table", "placement": "right", "values": ["value"]}
      },
      "fieldConfig": {
        "defaults": {
          "unit": "currencyUSD",
          "decimals": 2,
          "color": {"mode": "palette-classic"}
        }
      }
    },
    {
      "id": 13,
      "title": "ðŸ”¢ Ð¢Ð¾ÐºÐµÐ½Ñ‹ Ð¿Ð¾ Ð¼Ð¾Ð´ÐµÐ»ÑÐ¼",
      "type": "barchart",
      "gridPos": {"h": 12, "w": 8, "x": 8, "y": 10},
      "datasource": {"type": "postgres", "uid": "postgres"},
      "targets": [
        {
          "refId": "A",
          "format": "table",
          "rawSql": "SELECT\n  sl.model as model,\n  SUM(sl.prompt_tokens + sl.completion_tokens) as value\nFROM \"LiteLLM_SpendLogs\" sl\nWHERE\n  sl.\"startTime\" >= $__timeFrom()\n  AND sl.\"startTime\" < $__timeTo()\n  AND sl.metadata->>'user_api_key_team_alias' = 'OpenWebUI'\n  AND sl.end_user = '$selected_user'\n  AND sl.end_user IS NOT NULL\n  AND sl.end_user != ''\nGROUP BY sl.model\nHAVING SUM(sl.prompt_tokens + sl.completion_tokens) > 0\nORDER BY value DESC"
        }
      ],
      "options": {
        "orientation": "horizontal",
        "barWidth": 0.8,
        "legend": {"displayMode": "table", "placement": "right", "values": ["value"]}
      },
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "decimals": 0,
          "color": {"mode": "palette-classic"}
        }
      }
    },
    {
      "id": 14,
      "title": "ðŸ“Š Ð—Ð°Ð¿Ñ€Ð¾ÑÑ‹ Ð¿Ð¾ Ð¼Ð¾Ð´ÐµÐ»ÑÐ¼",
      "type": "barchart",
      "gridPos": {"h": 12, "w": 8, "x": 16, "y": 10},
      "datasource": {"type": "postgres", "uid": "postgres"},
      "targets": [
        {
          "refId": "A",
          "format": "table",
          "rawSql": "SELECT\n  sl.model as model,\n  COUNT(*) as value\nFROM \"LiteLLM_SpendLogs\" sl\nWHERE\n  sl.\"startTime\" >= $__timeFrom()\n  AND sl.\"startTime\" < $__timeTo()\n  AND sl.metadata->>'user_api_key_team_alias' = 'OpenWebUI'\n  AND sl.end_user = '$selected_user'\n  AND sl.end_user IS NOT NULL\n  AND sl.end_user != ''\nGROUP BY sl.model\nHAVING COUNT(*) > 0\nORDER BY value DESC"
        }
      ],
      "options": {
        "orientation": "horizontal",
        "barWidth": 0.8,
        "legend": {"displayMode": "table", "placement": "right", "values": ["value"]}
      },
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "decimals": 0,
          "color": {"mode": "palette-classic"}
        }
      }
    },
    {
      "id": 16,
      "title": "ðŸ“Š Ð ÐÐ¡ÐŸÐ Ð•Ð”Ð•Ð›Ð•ÐÐ˜Ð• ÐŸÐž ÐœÐžÐ”Ð•Ð›Ð¯Ðœ",
      "type": "row",
      "gridPos": {"h": 1, "w": 24, "x": 0, "y": 22},
      "collapsed": false
    },
    {
      "id": 17,
      "title": "ðŸ’° Ð Ð°ÑÑ…Ð¾Ð´Ñ‹ Ð¿Ð¾ Ð¼Ð¾Ð´ÐµÐ»ÑÐ¼",
      "type": "piechart",
      "gridPos": {"h": 8, "w": 8, "x": 0, "y": 23},
      "datasource": {"type": "postgres", "uid": "postgres"},
      "targets": [
        {
          "refId": "A",
          "format": "time_series",
          "rawSql": "SELECT\n  NOW() as time,\n  sl.model as metric,\n  SUM(sl.spend) as value\nFROM \"LiteLLM_SpendLogs\" sl\nWHERE\n  sl.\"startTime\" >= $__timeFrom()\n  AND sl.\"startTime\" < $__timeTo()\n  AND sl.metadata->>'user_api_key_team_alias' = 'OpenWebUI'\n  AND sl.end_user = '$selected_user'\n  AND sl.end_user IS NOT NULL\n  AND sl.end_user != ''\nGROUP BY sl.model\nHAVING SUM(sl.spend) > 0\nORDER BY value DESC\nLIMIT 8"
        }
      ],
      "options": {
        "pieType": "pie",
        "legend": {"displayMode": "table", "placement": "right", "values": ["value", "percent"]}
      },
      "fieldConfig": {
        "defaults": {
          "unit": "currencyUSD",
          "color": {"mode": "palette-classic"}
        }
      }
    },
    {
      "id": 18,
      "title": "ðŸ“Š Ð—Ð°Ð¿Ñ€Ð¾ÑÑ‹ Ð¿Ð¾ Ð¼Ð¾Ð´ÐµÐ»ÑÐ¼",
      "type": "piechart",
      "gridPos": {"h": 8, "w": 8, "x": 8, "y": 23},
      "datasource": {"type": "postgres", "uid": "postgres"},
      "targets": [
        {
          "refId": "A",
          "format": "time_series",
          "rawSql": "SELECT\n  NOW() as time,\n  sl.model as metric,\n  COUNT(*) as value\nFROM \"LiteLLM_SpendLogs\" sl\nWHERE\n  sl.\"startTime\" >= $__timeFrom()\n  AND sl.\"startTime\" < $__timeTo()\n  AND sl.metadata->>'user_api_key_team_alias' = 'OpenWebUI'\n  AND sl.end_user = '$selected_user'\n  AND sl.end_user IS NOT NULL\n  AND sl.end_user != ''\nGROUP BY sl.model\nHAVING COUNT(*) > 0\nORDER BY value DESC\nLIMIT 8"
        }
      ],
      "options": {
        "pieType": "pie",
        "legend": {"displayMode": "table", "placement": "right", "values": ["value", "percent"]}
      },
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "color": {"mode": "palette-classic"}
        }
      }
    },
    {
      "id": 19,
      "title": "ðŸ”¢ Ð¢Ð¾ÐºÐµÐ½Ñ‹ Ð¿Ð¾ Ð¼Ð¾Ð´ÐµÐ»ÑÐ¼",
      "type": "piechart",
      "gridPos": {"h": 8, "w": 8, "x": 16, "y": 23},
      "datasource": {"type": "postgres", "uid": "postgres"},
      "targets": [
        {
          "refId": "A",
          "format": "time_series",
          "rawSql": "SELECT\n  NOW() as time,\n  sl.model as metric,\n  SUM(sl.prompt_tokens + sl.completion_tokens) as value\nFROM \"LiteLLM_SpendLogs\" sl\nWHERE\n  sl.\"startTime\" >= $__timeFrom()\n  AND sl.\"startTime\" < $__timeTo()\n  AND sl.metadata->>'user_api_key_team_alias' = 'OpenWebUI'\n  AND sl.end_user = '$selected_user'\n  AND sl.end_user IS NOT NULL\n  AND sl.end_user != ''\nGROUP BY sl.model\nHAVING SUM(sl.prompt_tokens + sl.completion_tokens) > 0\nORDER BY value DESC\nLIMIT 8"
        }
      ],
      "options": {
        "pieType": "pie",
        "legend": {"displayMode": "table", "placement": "right", "values": ["value", "percent"]}
      },
      "fieldConfig": {
        "defaults": {
          "unit": "short",
          "color": {"mode": "palette-classic"}
        }
      }
    }
  ],
  "overwrite": true
}
